# Test Runner for NAT Testing
FROM alpine:3.20

# Install dependencies
RUN apk add --no-cache \
    bash \
    curl \
    jq \
    netcat-openbsd \
    tcpdump \
    iperf3 \
    git

# Create workspace
WORKDIR /workspace

# Create directories for test results
RUN mkdir -p /test-results /scripts

# Copy test scripts
COPY docker/scripts/ /scripts/
RUN chmod +x /scripts/*.sh

# Default environment
ENV RUST_LOG=info \
    RUST_BACKTRACE=1 \
    TEST_THREADS=1

ENTRYPOINT ["/scripts/run-enhanced-nat-tests.sh"]